const debounce=(func,wait)=>{let timeout;return function executedFunction(...args){const later=()=>{clearTimeout(timeout);func(...args)};clearTimeout(timeout);timeout=setTimeout(later,wait)}};function toggleContent(cardId){const card=document.querySelector(`[data-card-id="${cardId}"]`);if(!card)return;const preview=card.querySelector('.content-preview');const full=card.querySelector('.content-full');const button=card.querySelector('.read-more-btn');if(full.classList.contains('expanded')){full.classList.remove('expanded');preview.style.display='block';button.textContent='Read More'}else{full.classList.add('expanded');preview.style.display='none';button.textContent='Read Less'}}class MobileMenuManager{constructor(){this.mobileMenuIcon=document.querySelector('.mobile-menu-icon');this.navMenu=document.querySelector('.nav-menu');this.init()}init(){if(this.mobileMenuIcon){this.mobileMenuIcon.addEventListener('click',()=>this.toggleMenu())}}toggleMenu(){const isExpanded=this.mobileMenuIcon.getAttribute('aria-expanded')==='true';this.mobileMenuIcon.setAttribute('aria-expanded',!isExpanded);this.animateMenuLines(!isExpanded);this.toggleNavVisibility(!isExpanded)}animateMenuLines(expand){const lines=this.mobileMenuIcon.querySelectorAll('.menu-line');lines.forEach((line,index)=>{if(expand){if(index===0)line.style.transform='rotate(45deg) translate(6px, 6px)';if(index===1)line.style.opacity='0';if(index===2)line.style.transform='rotate(-45deg) translate(8px, -8px)'}else{line.style.transform='';line.style.opacity=''}})}toggleNavVisibility(show){if(this.navMenu){if(show){this.navMenu.classList.add('mobile-active')}else{this.navMenu.classList.remove('mobile-active')}}}resetMenu(){if(this.mobileMenuIcon){this.mobileMenuIcon.setAttribute('aria-expanded','false');const lines=this.mobileMenuIcon.querySelectorAll('.menu-line');lines.forEach(line=>{line.style.transform='';line.style.opacity=''})}if(this.navMenu){this.navMenu.classList.remove('mobile-active')}}}class InteractionManager{constructor(){this.navLinks=document.querySelectorAll('.nav-link');this.ctaButton=document.querySelector('.cta-button');this.mobileMenuManager=null;this.init()}init(){this.setupCTAButton();this.setupNavigationLinks();this.setupMainContentCards();this.setupReadMore();this.setupFAQInteraction();this.setupSEOAnalytics()}setupCTAButton(){if(!this.ctaButton)return;this._ctaClickHandler=(e)=>{e.preventDefault();this.handleCTAClick()};this._ctaKeydownHandler=(e)=>{if(e.key==='Enter'||e.key===' '){e.preventDefault();this.handleCTAClick()}};this.ctaButton.addEventListener('click',this._ctaClickHandler);this.ctaButton.addEventListener('keydown',this._ctaKeydownHandler)}handleCTAClick(){try{this.ctaButton.style.transform='scale(0.95)';setTimeout(()=>{this.ctaButton.style.transform=''},200);this.trackCTAClick();const target=this.ctaButton.getAttribute('href');if(target&&target!=='#'){window.location.href=target}else{window.location.href='/booking'}}catch(error){console.error('Error handling CTA click:',error);window.location.href='/booking'}}trackCTAClick(){try{if(typeof gtag!=='undefined'){gtag('event','cta_click',{'event_category':'engagement','event_label':'book_now','value':1})}if(typeof dataLayer!=='undefined'){dataLayer.push({'event':'cta_click','cta_type':'book_now','page_location':window.location.pathname})}}catch(error){console.error('Error tracking CTA click:',error)}}setupNavigationLinks(){const navContainer=document.querySelector('.nav-list');if(navContainer){this._navClickHandler=(e)=>{if(e.target.classList.contains('nav-link')){e.preventDefault();this.handleNavClick(e.target)}};this._navKeydownHandler=(e)=>{if(e.target.classList.contains('nav-link')&&(e.key==='Enter'||e.key===' ')){e.preventDefault();this.handleNavClick(e.target)}};navContainer.addEventListener('click',this._navClickHandler);navContainer.addEventListener('keydown',this._navKeydownHandler)}}handleNavClick(link){try{link.style.color='#CCCCCC';setTimeout(()=>{link.style.color=''},200);if(this.mobileMenuManager){this.mobileMenuManager.resetMenu()}const target=link.getAttribute('href');if(target&&target!=='#'&&target!=='/'){this.trackNavigation(target);window.location.href=target}}catch(error){console.error('Error handling navigation click:',error);const target=link.getAttribute('href');if(target&&target!=='#'){window.location.href=target}}}trackNavigation(target){try{if(typeof gtag!=='undefined'){gtag('event','navigation_click',{'event_category':'navigation','event_label':target})}if(typeof dataLayer!=='undefined'){dataLayer.push({'event':'navigation_click','page':target})}}catch(error){console.error('Error tracking navigation:',error)}}setupMainContentCards(){const cardSelectors=['.main-content-card','.content-card','.card','[class*="card"]','.article-card'];let allCards=[];cardSelectors.forEach(selector=>{const cards=document.querySelectorAll(selector);cards.forEach(card=>{if(!allCards.includes(card)){allCards.push(card)}})});allCards.forEach(card=>{card.addEventListener('click',(e)=>{e.preventDefault();this.handleMainContentClick(card)});card.addEventListener('keydown',(e)=>{if(e.key==='Enter'||e.key===' '){e.preventDefault();this.handleMainContentClick(card)}else if(e.key==='Escape'){this.handleEscapeKey(card)}});card.addEventListener('focus',()=>{this.handleCardFocus(card)});card.addEventListener('blur',()=>{this.handleCardBlur(card)})})}handleEscapeKey(card){const cardIndex=Array.from(document.querySelectorAll('.main-content-card')).indexOf(card);if(cardIndex!==-1){const modal=document.getElementById(`modal-${cardIndex}`);if(modal&&modal.style.display==='flex'){this.closeModal(`modal-${cardIndex}`);return}}card.focus()}handleCardFocus(card){card.style.outline='2px solid #f5a923';card.style.outlineOffset='2px';const cardTitle=card.querySelector('.main-content-title')?.textContent;if(cardTitle){this.announceToScreenReader(`Card ${cardTitle} focused`)}}handleCardBlur(card){card.style.outline='';card.style.outlineOffset=''}handleMainContentClick(card){const cardTitle=card.querySelector('.main-content-title')?.textContent;card.style.transform='translateY(-12px) scale(1.02)';setTimeout(()=>{card.style.transform=''},300);this.trackCardClick(cardTitle)}trackCardClick(cardTitle){try{if(typeof gtag!=='undefined'){gtag('event','card_click',{'event_category':'engagement','event_label':cardTitle||'main_content_card'})}}catch(error){console.error('Error tracking card click:',error)}}setupReadMore(){const cardSelectors=['.main-content-card','.content-card','.card','[class*="card"]','.article-card'];let allCards=[];cardSelectors.forEach(selector=>{const cards=document.querySelectorAll(selector);cards.forEach(card=>{if(!allCards.includes(card)){allCards.push(card)}})});allCards.forEach((card,index)=>{const cardTitle=this.findCardTitle(card);const contentText=this.findCardContent(card);if(!contentText||!cardTitle)return;if(this.shouldShowReadMore(contentText)){this.createReadMoreFunctionality(card,index,cardTitle,contentText.innerHTML)}})}findCardTitle(card){const selectors=['.main-content-title','.card-title','h2','h3','[class*="title"]'];for(const selector of selectors){const title=card.querySelector(selector);if(title){return title.textContent}}return null}findCardContent(card){const selectors=['.content-text','.card-content','.article-content','.content','p'];for(const selector of selectors){const content=card.querySelector(selector);if(content&&content.textContent.trim().length>50){const fullContent=this.getCompleteContent(card,content);return fullContent}}return null}getCompleteContent(card,contentElement){let fullContent=contentElement.innerHTML;const dataFullContent=card.getAttribute('data-full-content');if(dataFullContent){fullContent=dataFullContent}const hiddenElements=card.querySelectorAll('[style*="display: none"], .hidden-content, [class*="hidden"]');hiddenElements.forEach(element=>{if(element!==contentElement){fullContent+=element.innerHTML}});const additionalSelectors=['.additional-content','.full-content','.modal-content','.expanded-content'];additionalSelectors.forEach(selector=>{const additional=card.querySelector(selector);if(additional&&additional!==contentElement){fullContent+=additional.innerHTML}});const tempDiv=document.createElement('div');tempDiv.innerHTML=fullContent;return tempDiv}shouldShowReadMore(contentElement){if(!contentElement)return false;const text=contentElement.textContent.trim();const html=contentElement.innerHTML;if(text.length<300)return false;const paragraphs=contentElement.querySelectorAll('p');if(paragraphs.length>1)return true;const lists=contentElement.querySelectorAll('ul, ol');if(lists.length>0)return true;const subheadings=contentElement.querySelectorAll('h3, h4, h5, h6');if(subheadings.length>0)return true;const sentences=text.split(/[.!?]+/).filter(s=>s.trim().length>10);if(sentences.length>3)return true;return false}createReadMoreFunctionality(card,index,cardTitle,fullContent){const originalFullContent=fullContent;const previewContent=this.createPreviewContent(fullContent);const contentText=card.querySelector('.content-text');if(contentText){contentText.innerHTML=previewContent}let readMoreBtn=card.querySelector('.read-more-btn');if(!readMoreBtn){readMoreBtn=document.createElement('button');readMoreBtn.className='read-more-btn';readMoreBtn.textContent='Read More';readMoreBtn.setAttribute('aria-label',`Read more about ${cardTitle}`);const buttonContainer=this.findButtonContainer(card);if(buttonContainer){buttonContainer.appendChild(readMoreBtn)}}readMoreBtn.style.display='block';const cardId=card.getAttribute('data-card-id');let modalId=`modal-${index}`;if(cardId){modalId=`modal-${cardId}`}let modal=document.getElementById(modalId);if(!modal){modal=this.createModal(modalId,cardTitle,originalFullContent);document.body.appendChild(modal)}else{const modalBody=modal.querySelector('.modal-body');if(modalBody){modalBody.innerHTML=this.formatModalContent(originalFullContent)}}const clickHandler=(e)=>{e.preventDefault();e.stopPropagation();this.openModal(modalId)};const keydownHandler=(e)=>{if(e.key==='Enter'||e.key===' '){e.preventDefault();this.openModal(modalId)}};readMoreBtn._clickHandler=clickHandler;readMoreBtn._keydownHandler=keydownHandler;readMoreBtn.addEventListener('click',clickHandler);readMoreBtn.addEventListener('keydown',keydownHandler)}findButtonContainer(card){const selectors=['.article-content','.card-content','.content','.main-content-preview'];for(const selector of selectors){const container=card.querySelector(selector);if(container){return container}}return card}createPreviewContent(fullContent){const tempDiv=document.createElement('div');tempDiv.innerHTML=fullContent;const text=tempDiv.textContent.trim();if(text.length<=300){return fullContent}const paragraphs=tempDiv.querySelectorAll('p');const lists=tempDiv.querySelectorAll('ul, ol');const subheadings=tempDiv.querySelectorAll('h3, h4, h5, h6');if(paragraphs.length>1||lists.length>0||subheadings.length>0){const firstParagraph=tempDiv.querySelector('p');if(firstParagraph){const paragraphText=firstParagraph.textContent.trim();if(paragraphText.length>200){const truncated=paragraphText.substring(0,200)+'...';return `<p class="content-text">${truncated}</p>`}else{return firstParagraph.outerHTML}}}const firstParagraph=tempDiv.querySelector('p');if(firstParagraph){const paragraphText=firstParagraph.textContent.trim();if(paragraphText.length>200){const truncated=paragraphText.substring(0,200)+'...';return `<p class="content-text">${truncated}</p>`}else{return firstParagraph.outerHTML}}const truncated=text.substring(0,200)+'...';return `<p class="content-text">${truncated}</p>`}createModal(modalId,title,content){const modal=document.createElement('div');modal.id=modalId;modal.className='content-modal';modal.style.display='none';const formattedContent=this.formatModalContent(content);modal.innerHTML=`<div class="modal-overlay"></div><div class="modal-content"><div class="modal-header"><h2 class="modal-title">${title}</h2><button class="modal-close-btn" aria-label="Close modal">Ã—</button></div><div class="modal-body">${formattedContent}</div></div>`;return modal}formatModalContent(content){if(typeof content==='string'){return content}if(content&&content.innerHTML){return content.innerHTML}return content||''}openModal(modalId){const modal=document.getElementById(modalId);if(!modal){console.error('Modal not found for modalId:',modalId);return}console.log('Opening modal for modalId:',modalId);modal.style.display='flex';modal.style.opacity='1';modal.style.visibility='visible';document.body.style.overflow='hidden';document.body.classList.add('modal-open');const closeBtn=modal.querySelector('.modal-close-btn');if(closeBtn){closeBtn.focus()}this.setupModalCloseHandlers(modal,modalId);this.trackModalOpen(modalId);console.log('Modal opened successfully')}setupModalCloseHandlers(modal,modalId){const closeBtn=modal.querySelector('.modal-close-btn');const overlay=modal.querySelector('.modal-overlay');if(closeBtn){closeBtn.addEventListener('click',(e)=>{e.preventDefault();e.stopPropagation();this.closeModal(modalId)});closeBtn.addEventListener('touchend',(e)=>{e.preventDefault();e.stopPropagation();this.closeModal(modalId)})}if(overlay){overlay.addEventListener('click',(e)=>{if(e.target===overlay){this.closeModal(modalId)}});overlay.addEventListener('touchend',(e)=>{if(e.target===overlay){e.preventDefault();this.closeModal(modalId)}})}const escapeHandler=(e)=>{if(e.key==='Escape'){this.closeModal(modalId);document.removeEventListener('keydown',escapeHandler)}};document.addEventListener('keydown',escapeHandler);modal._escapeHandler=escapeHandler}closeModal(modalId){const modal=document.getElementById(modalId);if(!modal)return;modal.style.display='none';document.body.style.overflow='';document.body.classList.remove('modal-open');if(modal._escapeHandler){document.removeEventListener('keydown',modal._escapeHandler);delete modal._escapeHandler}const cardIndex=modalId.replace('modal-','');const card=document.querySelector(`.main-content-card:nth-child(${parseInt(cardIndex)*2+1})`);if(card){card.focus()}this.trackModalClose(modalId)}trackModalOpen(modalId){try{if(typeof gtag!=='undefined'){gtag('event','modal_open',{'event_category':'engagement','event_label':modalId})}}catch(error){console.error('Error tracking modal open:',error)}}trackModalClose(modalId){try{if(typeof gtag!=='undefined'){gtag('event','modal_close',{'event_category':'engagement','event_label':modalId})}}catch(error){console.error('Error tracking modal close:',error)}}announceToScreenReader(message){let liveRegion=document.getElementById('screen-reader-announcements');if(!liveRegion){liveRegion=document.createElement('div');liveRegion.id='screen-reader-announcements';liveRegion.setAttribute('aria-live','polite');liveRegion.setAttribute('aria-atomic','true');liveRegion.style.position='absolute';liveRegion.style.left='-10000px';liveRegion.style.width='1px';liveRegion.style.height='1px';liveRegion.style.overflow='hidden';document.body.appendChild(liveRegion)}liveRegion.textContent=message;setTimeout(()=>{liveRegion.textContent=''},1000)}setupFAQInteraction(){const faqCards=document.querySelectorAll('.faq-card');faqCards.forEach(faqCard=>{faqCard.addEventListener('click',()=>{faqCard.style.transform='scale(0.98)';setTimeout(()=>{faqCard.style.transform=''},150);this.trackFAQClick(faqCard)});faqCard.addEventListener('keydown',(e)=>{if(e.key==='Enter'||e.key===' '){e.preventDefault();faqCard.click()}});faqCard.addEventListener('focus',()=>{faqCard.setAttribute('aria-label','FAQ question and answer - Click for more details')});faqCard.addEventListener('blur',()=>{faqCard.setAttribute('aria-label','FAQ question and answer')})})}trackFAQClick(faqCard){try{const question=faqCard.querySelector('.faq-question')?.textContent;if(typeof gtag!=='undefined'){gtag('event','faq_click',{'event_category':'engagement','event_label':question||'faq_interaction'})}}catch(error){console.error('Error tracking FAQ click:',error)}}setupSEOAnalytics(){this.trackPageEngagement();this.trackScrollDepth();this.trackTimeOnPage()}trackPageEngagement(){try{if(typeof gtag!=='undefined'){gtag('event','page_view',{'page_title':document.title,'page_location':window.location.href})}}catch(error){console.error('Error tracking page engagement:',error)}}trackScrollDepth(){let maxScroll=0;const trackScroll=()=>{const scrollPercent=Math.round((window.scrollY/(document.body.scrollHeight-window.innerHeight))*100);if(scrollPercent>maxScroll){maxScroll=scrollPercent;if(maxScroll>=25&&maxScroll<50){this.trackScrollEvent('25%')}else if(maxScroll>=50&&maxScroll<75){this.trackScrollEvent('50%')}else if(maxScroll>=75&&maxScroll<100){this.trackScrollEvent('75%')}else if(maxScroll>=100){this.trackScrollEvent('100%')}}};this._scrollHandler=debounce(trackScroll,100);window.addEventListener('scroll',this._scrollHandler)}trackScrollEvent(depth){try{if(typeof gtag!=='undefined'){gtag('event','scroll_depth',{'event_category':'engagement','event_label':depth,'page_location':window.location.pathname})}}catch(error){console.error('Error tracking scroll event:',error)}}trackTimeOnPage(){const startTime=Date.now();this._beforeunloadHandler=()=>{try{const timeOnPage=Math.round((Date.now()-startTime)/1000);if(typeof gtag!=='undefined'){gtag('event','time_on_page',{'event_category':'engagement','event_label':timeOnPage+'s','value':timeOnPage})}}catch(error){console.error('Error tracking time on page:',error)}};window.addEventListener('beforeunload',this._beforeunloadHandler)}cleanup(){const readMoreBtns=document.querySelectorAll('.read-more-btn');readMoreBtns.forEach(btn=>{if(btn._clickHandler){btn.removeEventListener('click',btn._clickHandler);delete btn._clickHandler}if(btn._keydownHandler){btn.removeEventListener('keydown',btn._keydownHandler);delete btn._keydownHandler}});const dynamicModals=document.querySelectorAll('.content-modal');dynamicModals.forEach(modal=>{if(modal._escapeHandler){document.removeEventListener('keydown',modal._escapeHandler);delete modal._escapeHandler}modal.remove()});const navContainer=document.querySelector('.nav-list');if(navContainer){navContainer.removeEventListener('click',this._navClickHandler);navContainer.removeEventListener('keydown',this._navKeydownHandler)}if(this.ctaButton){this.ctaButton.removeEventListener('click',this._ctaClickHandler);this.ctaButton.removeEventListener('keydown',this._ctaKeydownHandler)}if(this._scrollHandler){window.removeEventListener('scroll',this._scrollHandler)}if(this._beforeunloadHandler){window.removeEventListener('beforeunload',this._beforeunloadHandler)}}}class ResponsiveManager{constructor(){this.mobileMenuManager=null;this.init()}init(){window.addEventListener('resize',debounce(()=>this.handleResize(),250))}handleResize(){const isMobile=window.innerWidth<=768;if(!isMobile&&this.mobileMenuManager){this.mobileMenuManager.resetMenu()}}}class App{constructor(){this.mobileMenuManager=null;this.interactionManager=null;this.responsiveManager=null}init(){if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',()=>this.setup())}else{this.setup()}}setup(){try{this.mobileMenuManager=new MobileMenuManager();this.interactionManager=new InteractionManager();this.responsiveManager=new ResponsiveManager();this.responsiveManager.mobileMenuManager=this.mobileMenuManager;this.interactionManager.mobileMenuManager=this.mobileMenuManager;window.addEventListener('beforeunload',()=>{this.cleanup()})}catch(error){console.error('Error initializing app:',error);this.setupFallback()}}setupFallback(){console.log('Running in fallback mode');const mobileMenuIcon=document.querySelector('.mobile-menu-icon');const navMenu=document.querySelector('.nav-menu');if(mobileMenuIcon&&navMenu){mobileMenuIcon.addEventListener('click',()=>{navMenu.classList.toggle('mobile-active')})}}cleanup(){if(this.interactionManager){this.interactionManager.cleanup()}if(this.mobileMenuManager){this.mobileMenuManager.resetMenu()}}}const app=new App();app.init();
